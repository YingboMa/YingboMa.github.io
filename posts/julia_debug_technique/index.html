<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/tachyons.css"> <link rel=icon  href="/assets/favicon.png"> <link rel=preconnect  href="https://fonts.gstatic.com"> <link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel=stylesheet > <title>A Strange but Effective Debugging Technique in Julia</title> <style> body { font-size: 16px; background: #f1f1f1; line-height: 1.8; font-family: "PT Serif", sans-serif; margin: 0 auto 0 auto; } a { color: #333; border-bottom: 3px solid #e1e1e1; text-decoration: none; transition: opacity .15s ease-in; } a:hover,a:focus { color: #000; border-bottom: 3px solid #c1c1c1; transition: opacity .15s ease-in; } .colbox-blue { background-color: #eef3f5; padding-top: 5px; padding-right: 10px; padding-left: 10px; padding-bottom: 5px; margin-left: 5px; margin-top: 5px; margin-bottom: 5px; border-radius: 0 10px 10px 0; border-left: 5px solid #4c9cf1; } blockquote { background: var(--block-background); border-left: 7px solid #a8a8a8; margin: 1.5em 10px; padding: 0.5em 10px; font-style: italic; } blockquote p { display: inline; } .hljs { font-family: "Fira Code", monospace; font-size: 14px; line-height: 1.35em; border-radius: 2px; } </style> <div class="pa5 pt4 pb4" style="margin: 0 auto; max-width: 900px; background: #ffffff"> <header> <div class="f2 lh-copy b"><a href="/" class="bn dim normal gray">Yingbo Ma</a></div> <nav> <ul class="flex list pl0 bt bb b--moon-gray mb4"> <li class="pa2 pl0"><a class="bn dim" href="/">Home</a> <li class=pa2 > <a class="bn dim" href="/blog/">Blog</a> </ul> </nav> </header> <h1 class="f2 lh-title normal dark-gray">A Strange but Effective Debugging Technique in Julia</h1> <div class="f5 lh-copy i gray">2021-12-17</div> <div class=franklin-content > <p>Often, most of the work during debugging is to reconstruct the intermediate states in an algorithm. A debugger can often facilitate this need, but it could be rather cumbersome to use if the breakpoint condition is complicated.</p> <p>In Julia, we usually develop a package with a Julia <a href="https://docs.julialang.org/en/v1/stdlib/REPL/">REPL</a> open on the side. All the code executed in the REPL resides in the <code>Main</code> module. Hence, one can access REPL variables via <code>Main.a_variable_name</code> in the package one is developing. While debugging, we need to send the intermediate states of a function to Julia REPL. Unfortunately, Julia forbids rebinding of a variable from another module. One can bypass this limitation by defining an unused variable like <code>_a &#61; Ref&#123;Any&#125;&#40;&#41;</code> in the REPL. Then, modify this variable via <code>Main._a&#91;&#93; &#61; a_state_of_interest_1, a_state_of_interest_2</code> in some function of a package.</p> <h3 class="b normal">An Example</h3> <pre><code class="julia hljs">julia&gt; <span class=hljs-keyword >function</span> foo(n)
           a = b = <span class=hljs-number >1</span>
           <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:n
               a, b = b, a + b
               <span class=hljs-keyword >if</span> a &lt;= <span class=hljs-number >0</span>
                   Main._a[] = a, b
               <span class=hljs-keyword >end</span>
           <span class=hljs-keyword >end</span>
           <span class=hljs-keyword >return</span> a
       <span class=hljs-keyword >end</span>
foo (generic <span class=hljs-keyword >function</span> with <span class=hljs-number >1</span> method)

julia&gt; _a = <span class=hljs-built_in >Ref</span>{<span class=hljs-built_in >Any</span>}()
Base.RefValue{<span class=hljs-built_in >Any</span>}(<span class=hljs-comment >#undef)</span>

julia&gt; foo(<span class=hljs-number >100</span>)
<span class=hljs-number >1298777728820984005</span>

julia&gt; _a
Base.RefValue{<span class=hljs-built_in >Any</span>}((-<span class=hljs-number >2437933049959450366</span>, <span class=hljs-number >3736710778780434371</span>))</code></pre> <script src="https://utteranc.es/client.js" repo="YingboMa/YingboMa.github.io" issue-term=pathname  theme=gruvbox-dark  crossorigin=anonymous  async> </script> <div class=page-foot > <div class="copyright bt b--moon-gray mt4 pt2"> <small class=gray > &copy; Yingbo Ma. Last modified: January 20, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </small> </div> </div> </div> </div>